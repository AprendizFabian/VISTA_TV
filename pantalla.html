<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pantalla Informativa - LUM</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

    body {
      margin: 0;
      height: 100vh;
      overflow: hidden;
      font-family: 'Poppins', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      background: radial-gradient(circle at top right, #2b2b2b, #000);
      position: relative;
    }

    /* üé® Fondo animado suave */
    body::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(130deg, #000000, #141414, #222222, #000000);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      z-index: 0;
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* üî∫ Decoraciones */
    .corner {
      position: absolute;
      width: 0;
      height: 0;
    }
    .corner.black {
      top: 0; left: 0;
      border-left: 250px solid #000;
      border-bottom: 220px solid transparent;
    }
    .corner.yellow {
      bottom: 0; right: 0;
      border-right: 200px solid #FFD60A;
      border-top: 160px solid transparent;
    }

    /* üñº Logo */
    .logo {
      position: absolute;
      top: 25px; left: 30px;
      width: 100px;
      z-index: 5;
      animation: floatLogo 4s ease-in-out infinite alternate;
    }
    @keyframes floatLogo {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(5px); opacity: 0.95; }
    }

    /* üíé Contenedor principal */
    .container {
      position: relative;
      z-index: 5;
      text-align: center;
      width: 600px;
      padding: 40px;
      border-radius: 25px;
      backdrop-filter: blur(12px);
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
      color: #fff;
      animation: fadeIn 1.2s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .title {
      font-size: 2.4rem;
      font-weight: 700;
      margin-bottom: 30px;
      color: #FFD60A;
      text-shadow: 0 0 20px rgba(255, 214, 10, 0.5);
    }

    .photo {
      width: 230px;
      height: 230px;
      border-radius: 50%;
      border: 6px solid #FFD60A;
      object-fit: cover;
      box-shadow: 0 0 35px rgba(255, 214, 10, 0.3);
      margin-bottom: 20px;
      animation: floatImg 5s ease-in-out infinite;
    }

    @keyframes floatImg {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    .nombre {
      font-size: 1.9rem;
      font-weight: 700;
      margin-top: 10px;
    }

    .mensaje {
      font-size: 1.2rem;
      font-style: italic;
      color: #ccc;
      margin-top: 5px;
    }

    canvas#confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="corner black"></div>
  <div class="corner yellow"></div>
  <img src="img/logo.png" class="logo">

  <div class="container" id="contenedor">
    <h1 class="title">Cargando datos...</h1>
  </div>

  <script src="js/data.js"></script>
  <script src="js/confetti.js"></script>
  <script>
    const tienda = localStorage.getItem("tienda") || "DS_CHICO";
    const TSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSUqiPVe2z89H6Gum_WF-13kMUpXse9-epmDlqkurHE9DFp_zUKt1dT4ptzyLfsi3SM8fTXf-AmJvea/pub?gid=0&single=true&output=tsv";

    let modo = "cumple", datosCumple = [], empleado = {}, index = 0;

    async function iniciar() {
      const filas = await obtenerFilas(TSV_URL);
      const idxEmpleado = filas.findIndex(f => f.toLowerCase().includes("empleado del mes"));
      const cumpleFilas = filas.slice(3, idxEmpleado);
      const empleadoFilas = filas.slice(idxEmpleado + 2, idxEmpleado + 3);

      datosCumple = cumpleFilas.map(parseFila).filter(x => x.nombre);
      if (empleadoFilas.length) empleado = parseFila(empleadoFilas[0]);

      mostrar();
      setInterval(() => cambiarPantalla(), 12000);
    }

    function mostrar() {
      const cont = document.getElementById("contenedor");
      cont.innerHTML = "";

      if (modo === "cumple" && datosCumple.length) {
        const c = datosCumple[index];
        cont.innerHTML = `
          <h1 class="title">üéÇ ¬°Feliz Cumplea√±os!</h1>
          <img src="${convertirLink(c.imagen)}" class="photo">
          <div class="nombre">${c.nombre}</div>
          <div class="mensaje">${c.mensaje}</div>`;
        lanzarConfeti();
        index = (index + 1) % datosCumple.length;
      } else {
        cont.innerHTML = `
          <h1 class="title">üèÜ Empleado del Mes</h1>
          <img src="${convertirLink(empleado.imagen)}" class="photo">
          <div class="nombre">${empleado.nombre}</div>
          <div class="mensaje">Por su excelente desempe√±o</div>`;
      }
    }

    function cambiarPantalla() {
      modo = (modo === "cumple") ? "empleado" : "cumple";
      mostrar();
    }

    iniciar();
    setInterval(iniciar, 60000);
  </script>
</body>
</html>
